<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.5.1"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Innodb Storage Engine과 lock에 대한 연구" /><meta name="author" content="Ian" /><meta property="og:locale" content="en_US" /><meta name="description" content="서론 Innodb Storage Engine은 Row Level Locking이라는 특별한 개념을 가지고 있다. 이 Record Lock이라는 개념을 가지면서 Table Level Lock만을 가진 MyIsam 엔진보다 Lock이 걸리는 범위가 좁아졌기 때문에 다량의 CRUD 작업이 일어나는 App에서는 Innodb엔진을 많이 사용하고 있다. 하지만 실제로 lock이 걸렸을 때에만 Innodb Lock Monitor에 표시되기 때문에 디버깅이 어렵다. 이 포스트에서는 Row Level Lock의 종류에 대해서 공부한 부분을 정리하려고 한다." /><meta property="og:description" content="서론 Innodb Storage Engine은 Row Level Locking이라는 특별한 개념을 가지고 있다. 이 Record Lock이라는 개념을 가지면서 Table Level Lock만을 가진 MyIsam 엔진보다 Lock이 걸리는 범위가 좁아졌기 때문에 다량의 CRUD 작업이 일어나는 App에서는 Innodb엔진을 많이 사용하고 있다. 하지만 실제로 lock이 걸렸을 때에만 Innodb Lock Monitor에 표시되기 때문에 디버깅이 어렵다. 이 포스트에서는 Row Level Lock의 종류에 대해서 공부한 부분을 정리하려고 한다." /><link rel="canonical" href="https://hyanggeun.github.io/posts/mysql-record-lock/" /><meta property="og:url" content="https://hyanggeun.github.io/posts/mysql-record-lock/" /><meta property="og:site_name" content="IAN.DEV.IO" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-14T23:00:00+09:00" /><meta name="google-site-verification" content="googleb4855459bf6754de.html" /> <script type="application/ld+json"> {"headline":"Innodb Storage Engine과 lock에 대한 연구","dateModified":"2021-03-14T23:00:00+09:00","description":"서론 Innodb Storage Engine은 Row Level Locking이라는 특별한 개념을 가지고 있다. 이 Record Lock이라는 개념을 가지면서 Table Level Lock만을 가진 MyIsam 엔진보다 Lock이 걸리는 범위가 좁아졌기 때문에 다량의 CRUD 작업이 일어나는 App에서는 Innodb엔진을 많이 사용하고 있다. 하지만 실제로 lock이 걸렸을 때에만 Innodb Lock Monitor에 표시되기 때문에 디버깅이 어렵다. 이 포스트에서는 Row Level Lock의 종류에 대해서 공부한 부분을 정리하려고 한다.","datePublished":"2021-03-14T23:00:00+09:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://hyanggeun.github.io/posts/mysql-record-lock/"},"url":"https://hyanggeun.github.io/posts/mysql-record-lock/","author":{"@type":"Person","name":"Ian"},"@context":"https://schema.org"}</script><title>Innodb Storage Engine과 lock에 대한 연구 | IAN.DEV.IO</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/favicon.ico"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon.ico"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon.ico"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">IAN.DEV.IO</a></div><div class="site-subtitle font-italic">공부 정리용 블로그</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <a href="https://github.com/hyanggeun" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['songsogu','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Innodb Storage Engine과 lock에 대한 연구</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Innodb Storage Engine과 lock에 대한 연구</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Mar 14, 2021, 11:00 PM +0900" > Mar 14 <i class="unloaded">2021-03-14T23:00:00+09:00</i> </span> by <span class="author"> Ian </span></div></div><div class="post-content"><h2 id="서론">서론</h2><p>Innodb Storage Engine은 Row Level Locking이라는 특별한 개념을 가지고 있다. 이 Record Lock이라는 개념을 가지면서 Table Level Lock만을 가진 MyIsam 엔진보다 Lock이 걸리는 범위가 좁아졌기 때문에 다량의 CRUD 작업이 일어나는 App에서는 Innodb엔진을 많이 사용하고 있다. 하지만 실제로 lock이 걸렸을 때에만 Innodb Lock Monitor에 표시되기 때문에 디버깅이 어렵다. 이 포스트에서는 Row Level Lock의 종류에 대해서 공부한 부분을 정리하려고 한다.</p><h2 id="lock의-종류">Lock의 종류</h2><p>Lock의 종류에는 Row-Level Lock과 Table-Level Lock이 존재한다. Innodb에서는 <code class="language-plaintext highlighter-rouge">LOCK TABLES messages WRITE</code> 같이 명시적으로 테이블을 잠그지 않는다면 Table-Level Lock에 대해서 고려할 필요가 없다.</p><h3 id="table-level-lock">Table-Level Lock</h3><p>테이블락의 종류에는 <strong>Regular lock</strong>, <strong>intention lock</strong>, <strong>auto-increment lock</strong> 3가지가 있다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/db/'>DB</a>, <a href='/categories/mysql/'>Mysql</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/db/" class="post-tag no-text-decoration" >DB</a> <a href="/tags/mysql/" class="post-tag no-text-decoration" >Mysql</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Innodb Storage Engine과 lock에 대한 연구 - IAN.DEV.IO&url=https://hyanggeun.github.io/posts/mysql-record-lock/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Innodb Storage Engine과 lock에 대한 연구 - IAN.DEV.IO&u=https://hyanggeun.github.io/posts/mysql-record-lock/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Innodb Storage Engine과 lock에 대한 연구 - IAN.DEV.IO&url=https://hyanggeun.github.io/posts/mysql-record-lock/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/mysqlbinlog/">binlog와 mysqlbinlog</a><li><a href="/posts/mysql/">Mysql 서버 설정</a><li><a href="/posts/golang-pointer/">Method Receiver에서 Pointer를 언제 붙여야 할까?</a><li><a href="/posts/custom-controller-workqueue/">Kubernetes Custom Controller Workqueue</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/db/">DB</a> <a class="post-tag" href="/tags/go/">Go</a> <a class="post-tag" href="/tags/mysql/">Mysql</a> <a class="post-tag" href="/tags/client-go/">client go</a> <a class="post-tag" href="/tags/controller/">controller</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/programming/">Programming</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/mysql/"><div class="card-body"> <span class="timeago small" > Nov 14, 2020 <i class="unloaded">2020-11-14T23:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Mysql 서버 설정</h3><div class="text-muted small"><p> Mysql 서버는 단 1개의 설정 파일만 사용한다. unix계열: my.cnf window계열: my.ini 이 파일의 이름은 변경이 불가능하며, Mysql 서버는 시작할 때 이 설정 파일을 참조하여 처음 발견된 설정 파일로 구동된다. my.cnf 파일의 탐색 순서 이 순서는 mysql을 직접 컴파일해서 설치한 경우에는 순서가 다를 수 ...</p></div></div></a></div><div class="card"> <a href="/posts/mysqlbinlog/"><div class="card-body"> <span class="timeago small" > Apr 29 <i class="unloaded">2021-04-29T12:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>binlog와 mysqlbinlog</h3><div class="text-muted small"><p> Binlog Binlog란? binlog는 DML(update, insert, delete) 실행시 시간과 함께 기록되는 로그이다. 데이터 복구와 Replication에 사용된다. Binlog를 활성화하기 위한 옵션들 my.cnf에 아래 옵션들을 넣어준다. log-bin=[binlog가 저장될 디렉토리와 파일명] ...</p></div></div></a></div><div class="card"> <a href="/posts/golang-pointer/"><div class="card-body"> <span class="timeago small" > Nov 6, 2020 <i class="unloaded">2020-11-06T10:33:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Method Receiver에서 Pointer를 언제 붙여야 할까?</h3><div class="text-muted small"><p> 개요 go 언어로 개발을 하다 보면 Method Receiver에 언제 포인터를 붙이고, 붙이지 말아야할지 헷갈릴 때가 있다. 한번 정리할 필요성을 느껴서 글로 정리해본다. 먼저 문제를 풀어보며 설명을 이어나가도록 하겠다. Method Receiver에 포인터가 꼭 필요한 곳은? 문제: age를 변수로 가지고 있는 Person이라는 구조체가 있...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/mysql/" class="btn btn-outline-primary"><p>Mysql 서버 설정</p></a> <a href="/posts/mysqlbinlog/" class="btn btn-outline-primary"><p>binlog와 mysqlbinlog</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//hyanggeun-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'https://hyanggeun.github.io/posts/mysql-record-lock/'; this.page.identifier = '/posts/mysql-record-lock/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://github.com/hyanggeun">Ian</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/db/">DB</a> <a class="post-tag" href="/tags/go/">Go</a> <a class="post-tag" href="/tags/mysql/">Mysql</a> <a class="post-tag" href="/tags/client-go/">client go</a> <a class="post-tag" href="/tags/controller/">controller</a> <a class="post-tag" href="/tags/kubernetes/">Kubernetes</a> <a class="post-tag" href="/tags/programming/">Programming</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://hyanggeun.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-4PYPGQT1WP"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-4PYPGQT1WP'); </script>
